<!DOCTYPE html>
<html lang="ms">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="description" content="Surat cinta interaktif untuk pasangan tersayang">
    <title>Surat Cinta untukmu | Ekspresi Perasaan</title>
    <style>
        @font-face {
            font-family: 'Caveat';
            src: url('fonts/Caveat-Regular.ttf') format('truetype');
        }
        @font-face {
            font-family: 'Dancing Script';
            src: url('fonts/DancingScript-Regular.ttf') format('truetype');
        }
        @font-face {
            font-family: 'Great Vibes';
            src: url('fonts/GreatVibes-Regular.ttf') format('truetype');
        }
        @font-face {
            font-family: 'Playfair Display';
            src: url('fonts/PlayfairDisplay-Regular.ttf') format('truetype');
        }
        @font-face {
            font-family: 'Roboto';
            src: url('fonts/Roboto-Regular.ttf') format('truetype');
        }
        body {
            font-family: 'Dancing Script', cursive;
            line-height: 1.6;
            color: #333;
            margin: 0;
            padding: 0;
            background-color: #fff5f5;
            position: relative;
            overflow-x: hidden;
            touch-action: manipulation;
            font-size: 14px;
        }
        h1 { color: #e74c3c; text-align: center; margin-bottom: 10px; font-size: 20px; }
        .subtitle { text-align: center; color: #666; margin-bottom: 20px; font-size: 14px; }
        .container {
            background-color: #fffafa;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            z-index: 10;
            display: none;
            max-width: 700px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            min-height: 33vh;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        .container.fade-in { opacity: 1; }
        .background-layer {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 0;
            pointer-events: none;
        }
        .progress-container { 
            width: 100%; 
            background-color: #f3f3f3; 
            border-radius: 20px; 
            margin: 15px 0; 
            overflow: hidden; 
            position: relative; 
        }
        .progress-bar { 
            height: 25px; 
            border-radius: 20px; 
            width: 0%; 
            transition: width 0.5s ease; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            color: white; 
            font-weight: bold; 
            font-size: 12px; 
        }
        .progress-bar.shake-progress { animation: shakeProgress 0.5s ease; }
        @keyframes shakeProgress {
            0% { transform: translateX(0); }
            25% { transform: translateX(-3px); }
            50% { transform: translateX(3px); }
            75% { transform: translateX(-3px); }
            100% { transform: translateX(0); }
        }
        .love-heart {
            position: absolute;
            color: #e74c3c;
            font-size: 10px;
            z-index: 15;
            transition: font-size 0.5s ease, transform 0.5s ease;
            pointer-events: none;
        }
        .question { margin-bottom: 15px; padding: 15px; background-color: #f8f9fa; border-radius: 8px; display: none; }
        .question.active { display: block; animation: fadeIn 0.5s ease; }
        .question h3 { font-family: 'Arial'; }
        .answer-options { display: flex; flex-direction: column; align-items: center; margin-top: 15px; }
        button {
            background-color: #e74c3c;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            font-size: 14px;
            margin: 6px 0;
            transition: all 0.3s;
            width: 80%;
            max-width: 250px;
            position: relative;
            overflow: hidden;
            box-shadow: 0 3px 0 #c0392b;
        }
        button::after {
            content: '';
            position: absolute;
            top: -50%;
            left: -100%;
            width: 50%;
            height: 200%;
            background: linear-gradient(120deg, rgba(255, 255, 255, 0) 0%, rgba(255, 255, 255, 0.4) 50%, rgba(255, 255, 255, 0) 100%);
            animation: shine 2s infinite;
            pointer-events: none;
        }
        @keyframes shine {
            0% { transform: translateX(-100%) rotate(45deg); }
            50% { transform: translateX(300%) rotate(45deg); }
            100% { transform: translateX(300%) rotate(45deg); }
        }
        button:disabled { background-color: #ccc; cursor: not-allowed; box-shadow: none; }
        button:disabled::after { display: none; }
        button:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 5px 0 #c0392b; }
        button:active:not(:disabled) { transform: translateY(1px); box-shadow: 0 1px 0 #c0392b; }
        button.check-answers { background: linear-gradient(45deg, #ff9a9e, #fad0c4); color: #333; font-weight: bold; margin: 20px auto; display: block; width: 180px; box-shadow: 0 3px 0 #e0a7a7; }
        button.check-answers:hover { box-shadow: 0 5px 0 #e0a7a7; }
        button.check-answers:active { box-shadow: 0 1px 0 #e0a7a7; }
        button.close-review, button.close-video { background-color: #e74c3c; color: white; margin-top: 10px; }
        input[type="text"] { padding: 10px; border: 2px solid #ff9a9e; border-radius: 25px; width: 80%; max-width: 250px; margin: 6px 0; font-size: 14px; text-align: center; transition: all 0.3s; }
        input[type="text"]:disabled { background-color: #f0f0f0; border-color: #ccc; }
        input[type="text"]:focus { outline: none; border-color: #e74c3c; box-shadow: 0 0 5px rgba(231, 76, 60, 0.5); }
        .shake { animation: shakeCustom 0.8s ease; border-color: #e74c3c !important; box-shadow: 0 0 10px rgba(231, 76, 60, 0.5) !important; }
        @keyframes shakeCustom {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            50% { transform: translateX(5px); }
            75% { transform: translateX(-5px); }
            100% { transform: translateX(5px); }
        }
        .love-letter { display: none; padding: 15px; background-color: #fff; border: 1px solid #ffcccc; border-radius: 8px; margin-top: 15px; text-align: center; }
        .love-letter h2 { color: #e74c3c; }
        .love-letter p { margin-bottom: 10px; }
        .signature { margin-top: 20px; text-align: right; }
        .copyright { margin-top: 40px; font-size: 10px; text-align: center; color: #999; line-height: 1.8; font-family: 'Arial', sans-serif; }
        .review-container { display: none; margin-top: 20px; padding: 15px; background-color: #f8f9fa; border-radius: 8px; font-family: 'Arial', sans-serif; }
        .review-container h3 { font-family: 'Arial', sans-serif; }
        .review-question { margin-bottom: 10px; padding-bottom: 10px; border-bottom: 1px solid #ddd; font-family: 'Arial', sans-serif; }
        .review-answer { margin-left: 15px; position: relative; padding-left: 20px; margin-bottom: 5px; font-family: 'Arial', sans-serif; }
        .review-answer::before { content: ''; position: absolute; left: 0; top: 50%; transform: translateY(-50%); width: 16px; height: 16px; border-radius: 50%; display: flex; align-items: center; justify-content: center; color: white; font-size: 10px; font-weight: bold; }
        .review-correct::before { background-color: #2ecc71; content: '✓'; }
        .review-half::before { background-color: #3498db; content: '~'; }
        .review-wrong::before { background-color: #e74c3c; content: '✗'; }
        .review-selected { font-weight: bold; border-left: 3px solid #e74c3c; padding-left: 17px; }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; } }
        .heart { color: #e74c3c; font-size: 20px; }
        .soft-element, .heart-splash {
            position: absolute;
            font-size: 18px;
            color: #ff9a9e;
            animation: floatSoft 8s ease-in-out infinite;
            opacity: 0.5;
            z-index: 0;
            user-select: none;
            pointer-events: none;
        }
        @keyframes floatSoft {
            0%, 100% { transform: translateY(0) rotate(0deg); }
            50% { transform: translateY(-20px) rotate(10deg); }
        }
        @keyframes splash {
            0% { transform: translateY(0); opacity: 1; }
            100% { transform: translateY(-100px); opacity: 0; }
        }
        .soft-emoji {
            position: absolute;
            font-size: 18px;
            color: #ff9a9e;
            opacity: 0.5;
            z-index: 0;
            user-select: none;
            pointer-events: none;
        }
        .love-effect {
            position: absolute;
            font-size: 20px;
            color: #ff9a9e;
            pointer-events: none;
            z-index: 50;
            animation: floatLove 1.5s ease-out forwards;
        }
        @keyframes floatLove {
            0% { opacity: 1; transform: translateY(0); }
            100% { opacity: 0; transform: translateY(-50px); }
        }
        .sparkle {
            position: absolute;
            font-size: 16px;
            color: #ff9a9e;
            z-index: 90;
            pointer-events: none;
            opacity: 1;
        }
        @keyframes sparkle {
            0% { opacity: 1; transform: translateX(0) translateY(0); }
            50% { opacity: 0.8; }
            100% { opacity: 0; transform: translateY(-50vh); }
        }
        .floating-circle {
            position: absolute;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background-color: rgba(255, 154, 158, 0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: #ff9a9e;
            pointer-events: none;
            z-index: 50;
            animation: floatCircle 2s ease-out forwards;
        }
        @keyframes floatCircle {
            0% { opacity: 1; transform: translateY(0) scale(1); }
            50% { opacity: 0.7; transform: translateY(-60px) scale(1.2); }
            100% { opacity: 0; transform: translateY(-120px) scale(1); }
        }
        .intro-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 245, 245, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
            z-index: 100;
            text-align: center;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        .intro-overlay.active { opacity: 1; }
        .intro-overlay.fade-out { opacity: 0; }
        .intro-title { 
            position: absolute; 
            top: 25% !important; 
            width: 100%;
            font-family: 'Great Vibes';
            font-size: 48px;
            color: #e74c3c;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
            opacity: 0;
        }
        .intro-subtitle { 
            position: absolute; 
            top: 32% !important; 
            width: 100%;
            font-family: 'Caveat';
            font-size: 36px;
            color: #ff9a9e;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1);
            opacity: 0;
        }
        .intro-gif { 
            position: absolute; 
            top: 50% !important; 
            width: 250px; 
            height: auto; 
            opacity: 0; 
            transition: opacity 1s ease; 
        }
        .intro-gif.float-up { 
            animation: floatUpIntro 1s ease-out forwards; 
        }
        .intro-text { 
            position: absolute; 
            top: 75%; 
            width: 100%;
            font-family: 'Roboto';
            font-size: 16px;
            color: #ff9a9e;
            opacity: 0;
            text-decoration: underline;
            transition: opacity 0.5s ease;
        }
        .intro-heart-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 90;
            pointer-events: none;
        }
        @keyframes floatUpIntro {
            0% { top: 50%; opacity: 1; }
            100% { top: 40%; opacity: 1; }
        }
        @keyframes floatUpText {
            0% { opacity: 0; transform: translateY(0); }
            100% { opacity: 1; transform: translateY(-10%); }
        }
        .float-up-text { animation: floatUpText 1s ease-out forwards; }
        @keyframes popOut {
            0% { transform: scale(1); }
            50% { transform: scale(1.2) translateY(-20px); }
            100% { transform: scale(1); }
        }
        .intro-text.pop-out, .lock-text.pop-out { animation: popOut 1s ease-in-out; }
        .intro-text.shake-text, .lock-text.shake-text { animation: shakeCustom 0.8s ease; }
        .finish-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 245, 245, 0.95);
            display: none;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 100;
            text-align: center;
            pointer-events: none;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        .finish-overlay.active { opacity: 1; display: flex; }
        .finish-overlay.fade-out { opacity: 0; }
        .finish-gif { 
            width: 250px; 
            height: auto; 
            opacity: 0; 
            position: absolute; 
            top: 50%; 
            transition: opacity 0.5s ease; 
        }
        .finish-gif.float-up { 
            animation: floatUp 1s ease-out forwards; 
        }
        .finish-text, .countdown, .lock-text {
            position: absolute;
            width: 100%;
            color: #e74c3c;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        .finish-text#finishText { 
            top: 40%; 
            font-family: 'Times New Roman';
            font-size: 24px;
            color: #e74c3c;
        }
        .finish-text#readyText { 
            top: 55%; 
            font-family: 'Dancing Script';
            font-size: 20px;
            color: #ff9a9e;
        }
        .countdown { 
            top: 60%; 
            font-family: 'Playfair Display';
            font-size: 40px;
            color: #e74c3c;
        }
        .countdown.arrow { font-size: 60px; }
        .lock-text { 
            top: 75%; 
            font-family: 'Roboto';
            font-size: 16px;
            color: #ff9a9e;
            text-decoration: underline;
        }
        @keyframes floatUp {
            0% { top: 50%; opacity: 1; }
            100% { top: 15%; opacity: 1; }
        }
        .heart-layer {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 90;
            pointer-events: none;
        }
        .cover-overlay { 
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 245, 245, 0.95);
            z-index: 99;
            display: none;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        .cover-overlay.active { display: block; opacity: 1; }
        .cover-overlay.fade-out { opacity: 0; }
        .lock-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(255, 245, 245, 0.95);
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            z-index: 200;
            text-align: center;
            opacity: 0;
            transition: opacity 0.5s ease;
        }
        .lock-overlay.active { opacity: 1; }
        .lock-overlay.fade-out { opacity: 0; }
        .lock-title {
            font-family: 'Great Vibes';
            font-size: 36px;
            color: #e74c3c;
            margin-bottom: 20px;
        }
        .lock-display {
            font-family: 'Arial';
            font-size: 24px;
            color: #333;
            background-color: #fff;
            padding: 10px 20px;
            border: 2px solid #ff9a9e;
            border-radius: 8px;
            margin-bottom: 20px;
            min-width: 100px;
            text-align: center;
        }
        .lock-buttons {
            display: grid;
            grid-template-columns: repeat(3, 60px);
            gap: 10px;
        }
        .lock-btn {
            background-color: #ff9a9e;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 50%;
            font-size: 18px;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 3px 0 #e0a7a7;
        }
        .lock-btn:hover:not(:disabled) { transform: translateY(-2px); box-shadow: 0 5px 0 #e0a7a7; }
        .lock-btn:active:not(:disabled) { transform: translateY(1px); box-shadow: 0 1px 0 #e0a7a7; }
        .lock-btn:disabled { background-color: #ccc; cursor: not-allowed; box-shadow: none; }
        .lock-status {
            font-family: 'Roboto';
            font-size: 16px;
            color: #e74c3c;
            margin-top: 20px;
        }
        .audio-controls-container {
            position: fixed;
            top: 10px;
            right: 10px;
            z-index: 20;
            background-color: #ffffff;
            padding: 8px;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            display: flex;
            flex-direction: column;
            align-items: center;
        }
        .audio-control {
            background-color: #ffffff;
            color: #333;
            border: 2px solid #e74c3c;
            padding: 4px 6px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: all 0.3s;
            box-shadow: 0 2px 0 #ccc;
            margin-bottom: 8px;
        }
        .audio-control.muted {
            background-color: #e74c3c;
            color: white;
            border-color: #c0392b;
            box-shadow: 0 2px 0 #c0392b;
        }
        .audio-control:hover { transform: translateY(-2px); box-shadow: 0 4px 0 #ccc; }
        .audio-control.muted:hover { box-shadow: 0 4px 0 #c0392b; }
        .audio-control:active { transform: translateY(1px); box-shadow: 0 1px 0 #ccc; }
        .audio-control.muted:active { box-shadow: 0 1px 0 #c0392b; }
        .video-container { display: none; margin-top: 20px; text-align: center; }
        .video-container video { width: 100%; max-width: 560px; height: 315px; border-radius: 8px; }
        .play-video-btn { background-color: #ff9a9e; width: 180px; margin: 0 auto; }
        .volume-control {
            display: flex;
            align-items: center;
            margin-bottom: 6px;
        }
        .volume-control label {
            font-size: 12px;
            margin-right: 5px;
            color: #e74c3c;
        }
        input[type="range"] {
            -webkit-appearance: none;
            width: 100px;
            height: 5px;
            background: #f3f3f3;
            border-radius: 5px;
            outline: none;
            transition: background 0.3s;
        }
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 15px;
            height: 15px;
            background: #e74c3c;
            border-radius: 50%;
            cursor: pointer;
        }
        input[type="range"]::-moz-range-thumb {
            width: 15px;
            height: 15px;
            background: #e74c3c;
            border-radius: 50%;
            cursor: pointer;
        }
        input[type="range"]:hover { background: #ffcccc; }
        @media (max-width: 600px) {
            body { font-size: 16px; }
            .container { padding: 15px; max-width: 90%; min-height: 33vh; }
            h1 { font-size: 22px; }
            .subtitle { font-size: 16px; }
            .progress-bar { height: 20px; font-size: 14px; }
            button { padding: 10px 15px; font-size: 16px; max-width: 220px; }
            input[type="text"] { padding: 10px; font-size: 16px; max-width: 220px; }
            .love-letter h2 { font-size: 18px; }
            .love-letter p { font-size: 16px; }
            .copyright { margin-top: 30px; font-size: 10px; }
            .soft-element { font-size: 16px; }
            .intro-gif { width: 200px; }
            .intro-title { font-size: 40px; top: 25% !important; }
            .intro-subtitle { font-size: 30px; top: 32% !important; }
            .intro-text { font-size: 14px; top: 75%; }
            .finish-gif { width: 200px; }
            .finish-text#finishText { font-size: 20px; top: 40%; }
            .finish-text#readyText { font-size: 18px; top: 55%; }
            .countdown { font-size: 36px; top: 60%; }
            .countdown.arrow { font-size: 54px; }
            .lock-text { font-size: 14px; top: 75%; }
            .audio-controls-container { top: 5px; right: 5px; padding: 6px; }
            .audio-control { padding: 4px 6px; font-size: 14px; margin-bottom: 6px; }
            .video-container video { height: 200px; }
            .volume-control label { font-size: 10px; }
            .lock-title { font-size: 30px; }
            .lock-display { font-size: 20px; }
            .lock-btn { padding: 12px; font-size: 16px; }
            .lock-status { font-size: 14px; }
            input[type="range"] { width: 80px; }
            .love-heart { font-size: 8px; }
            .sparkle { font-size: 14px; }
            .floating-circle { width: 16px; height: 16px; font-size: 10px; }
        }
    </style>
</head>
<body>
    <div class="background-layer" id="backgroundLayer"></div>
    <div class="love-heart" id="loveHeart">❤</div>

    <audio id="backgroundMusic" loop>
        <source src="A Himitsu - I Should Let You Go (feat. Nori).mp3" type="audio/mp3">
    </audio>
    <audio id="birthdayMusic" loop>
        <source src="HAPPY BIRTHDAY song - Smooth Jazz music for Birthday party.mp3" type="audio/mp3">
    </audio>
    <audio id="welcomeSound" loop>
        <source src="Welcome Song.mp3" type="audio/mp3">
    </audio>
    <audio id="awardsSound" loop>
        <source src="Awards Music.mp3" type="audio/mp3">
    </audio>
    <audio id="clickSound">
        <source src="normal click btn sound.mp3" type="audio/mp3">
    </audio>

    <div class="audio-controls-container">
        <button class="audio-control" id="muteBtn" onclick="toggleMute()">🔊</button>
        <div class="volume-control">
            <label for="bgVolume">BG Music:</label>
            <input type="range" id="bgVolume" min="0" max="100" value="75">
        </div>
        <div class="volume-control">
            <label for="clickVolume">Click:</label>
            <input type="range" id="clickVolume" min="0" max="100" value="75">
        </div>
    </div>

    <div class="lock-overlay" id="lockOverlay">
        <div class="lock-title">Masukkan PIN</div>
        <div class="lock-display" id="lockDisplay"></div>
        <div class="lock-buttons">
            <button class="lock-btn" onclick="enterPin(1)">1</button>
            <button class="lock-btn" onclick="enterPin(2)">2</button>
            <button class="lock-btn" onclick="enterPin(3)">3</button>
            <button class="lock-btn" onclick="enterPin(4)">4</button>
            <button class="lock-btn" onclick="enterPin(5)">5</button>
            <button class="lock-btn" onclick="enterPin(6)">6</button>
            <button class="lock-btn" onclick="enterPin(7)">7</button>
            <button class="lock-btn" onclick="enterPin(8)">8</button>
            <button class="lock-btn" onclick="enterPin(9)">9</button>
            <button class="lock-btn" onclick="backspacePin()" style="grid-column: 1;">⌫</button>
            <button class="lock-btn" onclick="enterPin(0)" style="grid-column: 2;">0</button>
            <button class="lock-btn" onclick="submitPin()" style="grid-column: 3;">➡</button>
        </div>
        <div class="lock-status" id="lockStatus">Masukkan 4 nombor PIN</div>
    </div>

    <div class="intro-overlay" id="introOverlay">
        <div class="intro-heart-layer" id="introHeartLayer"></div>
        <div class="intro-title" id="introTitle"></div>
        <div class="intro-subtitle" id="introSubtitle"></div>
        <img src="images/kiss.gif" alt="Cute Kiss GIF" class="intro-gif">
        <div class="intro-text" id="introText"></div>
    </div>
<div class="finish-overlay" id="finishOverlay">
        <div class="heart-layer" id="heartLayer"></div>
        <img src="images/yeay finish.gif" alt="Yeay Finish GIF" class="finish-gif">
        <div class="finish-text" id="finishText"></div>
        <div class="finish-text" id="readyText"></div>
        <div class="countdown" id="countdown"></div>
        <div class="lock-text" id="lockText"></div>
    </div>

    <div class="cover-overlay" id="coverOverlay"></div>

    <div class="container" id="mainContent">
        <h1>Seberapa nilai percent cinta kita? <span class="heart">❤</span></h1>
        <p class="subtitle">Jawablah beberapa soalan yang disediakan ni dengan jujur iya sayang</p>
        
        <div class="progress-container">
            <div class="progress-bar" id="progressBar">0%</div>
        </div>
        
        <div class="question active" id="question1">
            <h3>1. Sayang... sayangkan b?</h3>
            <div class="answer-options">
                <button onclick="selectAnswer(1, 100, this, 'correct')">Mestilah sayang</button>
                <button onclick="selectAnswer(1, 0, this, 'wrong')">Hurmm</button>
            </div>
        </div>
        
        <div class="question" id="question2">
            <h3>2. Apa warna favourite b?</h3>
            <div class="answer-options">
                <input type="text" id="colorAnswer" placeholder="Tulis warna di sini" onkeypress="handleEnter(event, checkColorAnswer)">
                <button id="submitColor" onclick="checkColorAnswer()">Hantar</button>
            </div>
        </div>
        
        <div class="question" id="question3">
            <h3>3. Favorite makanan yang b suka apa?</h3>
            <div class="answer-options">
                <button onclick="selectAnswer(3, 50, this, 'half')">Nasi goreng cina</button>
                <button onclick="selectAnswer(3, 75, this, 'correct')">Nasi goreng kampung + telur mata goyang</button>
                <button onclick="selectAnswer(3, 75, this, 'correct')">Kuey teow kungfu</button>
                <button onclick="selectAnswer(3, 100, this, 'correct')">Nasi goreng pattaya</button>
            </div>
        </div>
        
        <div class="question" id="question4">
            <h3>4. Bila kita mula mulakan bibit cinta?</h3>
            <div class="answer-options">
                <input type="text" id="dateAnswer" placeholder="Tulis tarikh di sini" onkeypress="handleEnter(event, checkDateAnswer)">
                <button id="submitDate" onclick="checkDateAnswer()">Hantar</button>
            </div>
        </div>
        
        <div class="question" id="question5">
            <h3>5. Suka ke tengok b senyum?</h3>
            <div class="answer-options">
                <button onclick="selectAnswer(5, 0, this, 'wrong')">Tak</button>
                <button onclick="selectAnswer(5, 100, this, 'correct')">Sebab nampak hensem</button>
                <button onclick="selectAnswer(5, 100, this, 'correct')">100% sukee gilerrr</button>
            </div>
        </div>
        
        <div class="question" id="question6">
            <h3>6. Selalu tak sayang pikirkan b?</h3>
            <div class="answer-options">
                <button onclick="selectAnswer(6, 100, this, 'correct')">Iya sayangku</button>
                <button onclick="selectAnswer(6, 50, this, 'half')">Bila teringat je</button>
                <button onclick="selectAnswer(6, 0, this, 'wrong')">Hm takk..</button>
            </div>
        </div>
        
        <div class="question" id="question7">
            <h3>7. Besar mana rasa kepedulian sayang kat b ni?</h3>
            <div class="answer-options">
                <button onclick="selectAnswer(7, 100, this, 'correct')">Besar Galaxy</button>
                <button onclick="selectAnswer(7, 50, this, 'half')">Separuh</button>
                <button onclick="selectAnswer(7, 0, this, 'wrong')">Nape tanya</button>
            </div>
        </div>
        
        <div class="question" id="question8">
            <h3>8. Pernah tak... sayang <strong>terpikir/imaginasi</strong> tentang "masa depan" dengan b tak?</h3>
            <div class="answer-options">
                <button onclick="selectAnswer(8, 100, this, 'correct')">Banyak sangattt</button>
                <button onclick="selectAnswer(8, 50, this, 'half')">Kadang" je</button>
                <button onclick="selectAnswer(8, 0, this, 'wrong')">Jarang</button>
            </div>
        </div>
        
        <div class="question" id="question9">
            <h3>9. Berapa percent pentingnya b dalam hidup sayang?</h3>
            <div class="answer-options">
                <button onclick="selectAnswer(9, 0, this, 'wrong')">25%</button>
                <button onclick="selectAnswer(9, 50, this, 'half')">50%</button>
                <button onclick="selectAnswer(9, 50, this, 'half')">75%</button>
                <button onclick="selectAnswer(9, 75, this, 'correct')">99.9%</button>
                <button onclick="selectAnswer(9, 100, this, 'correct')">100%</button>
            </div>
        </div>
        
        <div class="question" id="question10">
            <h3>10. Sayang betul-betul cintakan b?</h3>
            <div class="answer-options">
                <button onclick="selectAnswer(10, 100, this, 'correct')">Dengan sepenuh hati b</button>
                <button onclick="selectAnswer(10, 50, this, 'half')">Mungkin</button>
                <button onclick="selectAnswer(10, 0, this, 'wrong')">Tak yakinlah</button>
            </div>
        </div>
        
        <div style="display: flex; justify-content: center;">
            <button class="check-answers" onclick="showReview()" id="reviewBtn" style="display:none;">Periksa Jawapan Tadi</button>
        </div>
        
        <div class="review-container" id="reviewContainer">
            <h3>Semakan Jawapan Tadi</h3>
            <div id="reviewContent"></div>
            <button class="close-review" onclick="hideReview()">Tutup Semakan</button>
        </div>
<div class="love-letter" id="loveLetter">
            <h2 style="font-family: 'Great Vibes'; font-size: 24px; color: #e74c3c;">Untukmu Sayangku... 🌸</h2>
            <p style="font-family: 'Times New Roman'; font-size: 20px; color: #ff9a9e;">Thankyou sayangku 🫶🏻💕</p>
            <p style="font-family: 'Dancing Script'; font-size: 16px; color: #666;">Apapun hasil dari percent dari jawapan ini, cukuplah kita berusaha untuk jadi lebih terbaik di masa hadapan 🌟</p>
            <h2 style="font-family: 'Roboto'; font-size: 18px; color: #e74c3c;">Mana yang terkurang, boleh diusaha. Yang perfect, ditambahkan lagi! ✨</h2>
            <p style="font-family: 'Times New Roman'; font-size: 20px; color: #ff9a9e;">Thankyou sayang... sebab dah bersama dengan b, selama ratusan ribuan tahunan saatan sehingga kinian.. masih tetap berdiri tegak pacak di sisi b.. 💞</p>
            <p style="font-family: 'Arial'; font-size: 20px; color: #333;">InshaAllah masukkan dalam doa kita berdua, <strong style="color: #e74c3c;">"Semoga Allah merestui dan memberikan kita berdua berjalan bersama dari pelaminan nikah, menjadi mempelai mahligai di dunia, dan akhirnya bersatu di singgahsana syurga."</strong> 🙏🏻🌹</p>
            <p style="font-family: 'Dancing Script'; font-size: 18px; color: #333;">Semoga kita sama-sama bahagia selamanya, hingga ke syurga-Nya, <strong style="color: #e74c3c;">aamin</strong> 🤲🏻🌙🕊️</p>
            <p style="font-family: 'Times New Roman'; font-size: 16px; color: #555; font-style: italic;">"Selamat Harijadi buah hati b ini yang <strong style="color: #e74c3c;">ke-20</strong> sempena pada tarikh 24 April 2025, semoga sentiasa menjadi anak yang solehah, sentiasa berusaha menjadi lagi terbaik dari yang terbaik! b sama-sama doakan kesejahteraan, keselamatan, kebahagiaan kita berdua bermula dari sekarang.. sehingga la di kemudian hari, <strong style="color: #e74c3c;">aamin YA Rabbal A'lamin</strong> 🤲🏻"</p>
            <div class="signature">
                <p style="font-family: 'Dancing Script'; font-size: 14px; color: #666; font-style: italic;">~ sekian dari usaha b yang tidak ternilai ini ~ 🌼</p>
                <p style="font-family: 'Roboto'; font-size: 22px; color: #e74c3c;">💖🐻</p>
                <p style="font-family: 'Roboto'; font-size: 17px; color: #333; font-style: normal;"><strong>love you sayangku</strong> 💓</p>
            </div>
            <button class="play-video-btn" onclick="showVideo()">Main Video Istimewa 🎥</button>
            <div class="video-container" id="videoContainer">
                <video controls loop id="specialVideo">
                    <source src="Happy Birthday - Ariana.mp4" type="video/mp4">
                    Video tidak disokong oleh pelayar anda.
                </video>
                <button class="close-video" onclick="hideVideo()">Close</button>
            </div>
        </div>
        
        <div class="copyright">
            Copyright ©️ mdanialarif07@gmail.com<br>
            #Arifanaksulung, #BabybecarAriana
        </div>
    </div>

    <script>
        let currentQuestion = 1;
        let totalScore = 0;
        const maxScore = 1000;
        let answers = [];
        let isSubmitted = false;
        let wasMutedManually = false;
        let heartLoop;
        let sparkleLoop;
        let pinInput = [];
        let attemptsLeft = 3;
        const correctPin = "5210"; // PIN: 5210

        const allQuestions = [
            { question: "1. Sayang... sayangkan b?", options: [{ text: "Mestilah sayang", score: 100, type: "correct" }, { text: "Hurmm", score: 0, type: "wrong" }] },
            { question: "2. Apa warna favourite b?", options: [{ text: "biru", score: 100, type: "correct" }, { text: "hitam", score: 75, type: "correct" }] },
            { question: "3. Favorite makanan yang b suka apa?", options: [{ text: "Nasi goreng cina", score: 50, type: "half" }, { text: "Nasi goreng kampung + telur mata goyang", score: 75, type: "correct" }, { text: "Kuey teow kungfu", score: 75, type: "correct" }, { text: "Nasi goreng pattaya", score: 100, type: "correct" }] },
            { question: "4. Bila kita mula mulakan bibit cinta?", options: [{ text: "19 Disember 2022", score: 100, type: "correct" }] },
            { question: "5. Suka ke tengok b senyum?", options: [{ text: "Tak", score: 0, type: "wrong" }, { text: "Sebab nampak hensem", score: 100, type: "correct" }, { text: "100% sukee gilerrr", score: 100, type: "correct" }] },
            { question: "6. Selalu tak sayang pikirkan b?", options: [{ text: "Iya sayangku", score: 100, type: "correct" }, { text: "Bila teringat je", score: 50, type: "half" }, { text: "Hm takk..", score: 0, type: "wrong" }] },
            { question: "7. Besar mana rasa kepedulian sayang kat b ni?", options: [{ text: "Besar Galaxy", score: 100, type: "correct" }, { text: "Separuh", score: 50, type: "half" }, { text: "Nape tanya", score: 0, type: "wrong" }] },
            { question: "8. Pernah tak... sayang <strong>terpikir/imaginasi</strong> tentang \"masa depan\" dengan b tak?", options: [{ text: "Banyak sangattt", score: 100, type: "correct" }, { text: "Kadang\" je", score: 50, type: "half" }, { text: "Jarang", score: 0, type: "wrong" }] },
            { question: "9. Berapa percent pentingnya b dalam hidup sayang?", options: [{ text: "25%", score: 0, type: "wrong" }, { text: "50%", score: 50, type: "half" }, { text: "75%", score: 50, type: "half" }, { text: "99.9%", score: 75, type: "correct" }, { text: "100%", score: 100, type: "correct" }] },
            { question: "10. Sayang betul-betul cintakan b?", options: [{ text: "Dengan sepenuh hati b", score: 100, type: "correct" }, { text: "Mungkin", score: 50, type: "half" }, { text: "Tak yakinlah", score: 0, type: "wrong" }] }
        ];

        document.addEventListener('DOMContentLoaded', function() {
            const lockOverlay = document.getElementById('lockOverlay');
            const introOverlay = document.getElementById('introOverlay');
            const finishOverlay = document.getElementById('finishOverlay');
            const coverOverlay = document.getElementById('coverOverlay');
            const mainContent = document.getElementById('mainContent');
            const backgroundLayer = document.getElementById('backgroundLayer');
            const backgroundMusic = document.getElementById('backgroundMusic');
            const birthdayMusic = document.getElementById('birthdayMusic');
            const welcomeSound = document.getElementById('welcomeSound');
            const awardsSound = document.getElementById('awardsSound');
            const clickSound = document.getElementById('clickSound');
            const video = document.getElementById('specialVideo');
            const bgVolume = document.getElementById('bgVolume');
            const clickVolume = document.getElementById('clickVolume');
            const introGif = document.querySelector('.intro-gif');
            const introTitle = document.getElementById('introTitle');
            const introSubtitle = document.getElementById('introSubtitle');
            const introText = document.getElementById('introText');
            const introHeartLayer = document.getElementById('introHeartLayer');

            backgroundMusic.volume = 0.75;
            birthdayMusic.volume = 0.75;
            clickSound.volume = 0.75;

            lockOverlay.classList.add('active');

            bgVolume.addEventListener('input', function() {
                const activeMusic = document.getElementById('loveLetter').style.display === 'block' ? birthdayMusic : backgroundMusic;
                activeMusic.volume = this.value / 100;
                if (activeMusic.volume === 0) {
                    document.getElementById('muteBtn').textContent = '🔇';
                    document.getElementById('muteBtn').classList.add('muted');
                    wasMutedManually = true;
                } else {
                    document.getElementById('muteBtn').textContent = '🔊';
                    document.getElementById('muteBtn').classList.remove('muted');
                    wasMutedManually = false;
                }
            });
            
            clickVolume.addEventListener('input', function() {
                clickSound.volume = this.value / 100;
            });
            
            introOverlay.addEventListener('click', function() {
                if (introOverlay.style.pointerEvents === 'auto') {
                    introOverlay.classList.add('fade-out');
                    welcomeSound.pause();
                    setTimeout(() => {
                        introOverlay.style.display = 'none';
                        mainContent.style.display = 'block';
                        mainContent.classList.add('fade-in');
                        createSoftBackground(backgroundLayer);
                        if (!wasMutedManually) backgroundMusic.play();
                        positionLoveHeart();
                    }, 500);
                }
            });

            finishOverlay.addEventListener('click', function() {
                if (finishOverlay.style.pointerEvents === 'auto') {
                    finishOverlay.classList.add('fade-out');
                    coverOverlay.classList.add('fade-out');
                    awardsSound.pause();
                    clearInterval(heartLoop);
                    clearInterval(sparkleLoop);
                    setTimeout(() => {
                        finishOverlay.style.display = 'none';
                        coverOverlay.style.display = 'none';
                        mainContent.style.display = 'block';
                        mainContent.classList.add('fade-in');
                        showLoveLetter();
                        if (!wasMutedManually) birthdayMusic.play();
                    }, 1500);
                }
            });

            video.addEventListener('play', function() {
                birthdayMusic.pause();
                document.getElementById('muteBtn').textContent = '🔇';
                document.getElementById('muteBtn').classList.add('muted');
            });
            video.addEventListener('pause', function() {
                if (!wasMutedManually) {
                    birthdayMusic.play();
                    document.getElementById('muteBtn').textContent = '🔊';
                    document.getElementById('muteBtn').classList.remove('muted');
                }
            });

            window.addEventListener('resize', positionLoveHeart);
        });

        function enterPin(num) {
            if (attemptsLeft <= 0) return;
            document.getElementById('clickSound').play();
            createLoveEffect(event);
            if (pinInput.length < 4) {
                pinInput.push(num);
                updatePinDisplay();
            }
        }

        function backspacePin() {
            if (attemptsLeft <= 0) return;
            document.getElementById('clickSound').play();
            createLoveEffect(event);
            if (pinInput.length > 0) {
                pinInput.pop();
                updatePinDisplay();
            }
        }
function submitPin() {
            if (attemptsLeft <= 0) return;
            document.getElementById('clickSound').play();
            createLoveEffect(event);
            const lockOverlay = document.getElementById('lockOverlay');
            const introOverlay = document.getElementById('introOverlay');
            const introGif = document.querySelector('.intro-gif');
            const introTitle = document.getElementById('introTitle');
            const introSubtitle = document.getElementById('introSubtitle');
            const introText = document.getElementById('introText');
            const introHeartLayer = document.getElementById('introHeartLayer');
            const lockStatus = document.getElementById('lockStatus');

            if (pinInput.length !== 4) {
                lockStatus.textContent = "PIN mesti 4 nombor!";
                return;
            }

            const enteredPin = pinInput.join('');
            if (enteredPin === correctPin) {
                lockOverlay.classList.add('fade-out');
                setTimeout(() => {
                    lockOverlay.style.display = 'none';
                    introOverlay.classList.add('active');
                    document.getElementById('welcomeSound').play();
                    setTimeout(() => {
                        introGif.style.opacity = 1;
                        createSoftEmojis(introHeartLayer);
                        setTimeout(() => {
                            introGif.classList.add('float-up');
                            setTimeout(() => {
                                typeText(introTitle, "Welcome", 100, () => {
                                    setTimeout(() => {
                                        typeText(introSubtitle, "Nur Ariana Dazilah ~", 100, () => {
                                            setTimeout(() => {
                                                introText.textContent = "Tekan sahaja di mana-mana bahagian skrin";
                                                introText.style.opacity = 1;
                                                introText.classList.add('float-up-text');
                                                introText.classList.add('pop-out');
                                                introOverlay.style.pointerEvents = 'auto';
                                                startShakeTimer(introOverlay, introText, 'intro');
                                            }, 2000);
                                        });
                                    }, 1000);
                                });
                            }, 1000);
                        }, 500);
                    }, 100);
                }, 500);
            } else {
                attemptsLeft--;
                lockStatus.textContent = `PIN salah! Percubaan lagi: ${attemptsLeft}`;
                pinInput = [];
                updatePinDisplay();
                if (attemptsLeft <= 0) {
                    lockStatus.textContent = "Akses Ditolak!";
                    document.querySelectorAll('.lock-btn').forEach(btn => btn.disabled = true);
                }
            }
        }

        function updatePinDisplay() {
            const lockDisplay = document.getElementById('lockDisplay');
            lockDisplay.textContent = pinInput.map(() => '*').join(' ');
        }

        function createSoftBackground(layer) {
            const softSymbols = ['❤', '🌸', '🌼', '✿', '❀', '💗', '🌷', '💞'];
            for (let i = 0; i < 70; i++) {
                const element = document.createElement('div');
                element.className = 'soft-element';
                element.textContent = softSymbols[Math.floor(Math.random() * softSymbols.length)];
                element.style.left = Math.random() * 100 + '%';
                element.style.top = Math.random() * 100 + '%';
                element.style.fontSize = (Math.random() * 20 + 12) + 'px';
                element.style.animationDuration = (Math.random() * 4 + 6) + 's';
                element.style.animationDelay = Math.random() * 3 + 's';
                layer.appendChild(element);
            }
        }

        function createSoftEmojis(layer) {
            const softSymbols = ['❤', '🌸', '🌼', '💖'];
            for (let i = 0; i < 40; i++) {
                const emoji = document.createElement('div');
                emoji.className = 'soft-emoji';
                emoji.textContent = softSymbols[Math.floor(Math.random() * softSymbols.length)];
                emoji.style.left = Math.random() * 100 + '%';
                emoji.style.top = Math.random() * 100 + '%';
                emoji.style.fontSize = (Math.random() * 8 + 12) + 'px';
                layer.appendChild(emoji);
            }
        }

        function createHeartSplash(layer) {
            const symbols = ['❤', '🌸'];
            const heart = document.createElement('div');
            heart.className = 'heart-splash';
            heart.textContent = symbols[Math.floor(Math.random() * 2)];
            heart.style.left = `${Math.random() * 80 + 10}%`;
            heart.style.top = '70%';
            heart.style.fontSize = `${Math.random() * 8 + 12}px`;
            heart.style.animation = `splash ${Math.random() * 1 + 1}s ease-out`;
            layer.appendChild(heart);
            setTimeout(() => heart.remove(), 2000);
        }

        function createLoveEffect(event) {
            const symbols = ['❤', '🌸', '💖'];
            const button = event.target;
            const rect = button.getBoundingClientRect();
            const love = document.createElement('div');
            love.className = 'love-effect';
            love.textContent = symbols[Math.floor(Math.random() * symbols.length)];
            love.style.left = `${rect.left + rect.width / 2}px`;
            love.style.top = `${rect.top + rect.height / 2}px`;
            document.body.appendChild(love);
            setTimeout(() => love.remove(), 1500);
        }

        function createSparkle(layer) {
            const sparkleSymbols = ['✨', '🌸', '💖', '🌟', '💫', '🌼'];
            for (let i = 0; i < 20; i++) {
                const sparkle = document.createElement('div');
                sparkle.className = 'sparkle';
                sparkle.textContent = sparkleSymbols[Math.floor(Math.random() * sparkleSymbols.length)];
                const isLeft = Math.random() < 0.5;
                sparkle.style.left = isLeft ? `${Math.random() * 10}%` : `${90 + Math.random() * 10}%`;
                sparkle.style.top = '100%';
                sparkle.style.fontSize = `${Math.random() * 10 + 12}px`;
                sparkle.style.animation = `sparkle ${Math.random() * 2 + 2}s ease-out`;
                sparkle.style.transform = `translateX(${isLeft ? Math.random() * 20 : -Math.random() * 20}%)`;
                layer.appendChild(sparkle);
                setTimeout(() => sparkle.remove(), 4000);
            }
        }

        function startHeartLoop(layer) {
            heartLoop = setInterval(() => {
                for (let i = 0; i < 3; i++) {
                    createHeartSplash(layer);
                }
            }, 2000);
        }

        function startSparkleLoop(layer) {
            sparkleLoop = setInterval(() => {
                createSparkle(layer);
            }, 1000);
        }

        function positionLoveHeart() {
            const container = document.getElementById('mainContent');
            const progressBar = document.getElementById('progressBar');
            const loveHeart = document.getElementById('loveHeart');
            
            if (container.style.display === 'block') {
                const containerRect = container.getBoundingClientRect();
                const progressRect = progressBar.getBoundingClientRect();
                loveHeart.style.left = `${containerRect.right +  10}px`;
                loveHeart.style.top = `${progressRect.bottom}px`;
            }
        }

        function updateLoveHeart(percentage) {
            const loveHeart = document.getElementById('loveHeart');
            const maxSize = 40;
            const minSize = 10;
            const growthRange = maxSize - minSize;
            let size = percentage <= 40 ? minSize + (growthRange * (percentage / 40)) : maxSize;
            loveHeart.style.fontSize = `${size}px`;
            loveHeart.style.transform = `translateY(-${percentage * 0.5}px)`;
        }

        function disableOptions(questionNum) {
            const buttons = document.querySelectorAll(`#question${questionNum} button`);
            buttons.forEach(btn => btn.disabled = true);
            const input = document.querySelector(`#question${questionNum} input`);
            if (input) input.disabled = true;
        }

        function selectAnswer(questionNum, score, button, type) {
            if (isSubmitted) return;
            document.getElementById('clickSound').play();
            createLoveEffect(event);
            const buttons = button.parentElement.querySelectorAll('button');
            buttons.forEach(btn => btn.className = '');
            button.classList.add(type);
            
            answers[questionNum-1] = {
                question: document.querySelector(`#question${questionNum} h3`).textContent,
                answer: button.textContent,
                type: type,
                score: score
            };
            
            totalScore += score;
            updateProgressBar();
            disableOptions(questionNum);
            document.getElementById(`question${questionNum}`).classList.remove('active');
            
            if (questionNum === 10) {
                document.getElementById('backgroundMusic').pause();
                document.getElementById('coverOverlay').classList.add('active');
                setTimeout(showFinishOverlay, 1500);
                document.getElementById('reviewBtn').style.display = 'block';
                sendEmail();
                isSubmitted = true;
                return;
            }
            
            currentQuestion++;
            document.getElementById(`question${currentQuestion}`).classList.add('active');
        }
function showFinishOverlay() {
            const finishOverlay = document.getElementById('finishOverlay');
            const finishGif = document.querySelector('.finish-gif');
            const finishText = document.getElementById('finishText');
            const finishReady = document.getElementById('readyText');
            const countdown = document.getElementById('countdown');
            const lockText = document.getElementById('lockText');
            const heartLayer = document.getElementById('heartLayer');
            const mainContent = document.getElementById('mainContent');

            mainContent.style.display = 'none';
            finishOverlay.style.display = 'flex';
            finishOverlay.classList.add('active');
            document.getElementById('awardsSound').play();
            startHeartLoop(heartLayer);
            startSparkleLoop(heartLayer);
            
            setTimeout(() => {
                finishGif.style.opacity = 1;
                setTimeout(() => {
                    finishGif.classList.add('float-up');
                    setTimeout(() => {
                        typeText(finishText, "Yeayy !! finally sayang dah sampai kat peringkat terakhir !", 100, () => {
                            finishText.classList.add('float-up-text');
                            setTimeout(() => {
                                typeText(finishReady, "Sayang dah ready .. ?", 100, () => {
                                    finishReady.classList.add('float-up-text');
                                    setTimeout(() => {
                                        startCountdown(countdown, () => {
                                            countdown.classList.add('float-up-text');
                                            setTimeout(() => {
                                                lockText.textContent = "Dah boleh tekan skrin...";
                                                lockText.style.opacity = 1;
                                                lockText.classList.add('float-up-text');
                                                lockText.classList.add('pop-out');
                                                finishOverlay.style.pointerEvents = 'auto';
                                                startShakeTimer(finishOverlay, lockText, 'finish');
                                            }, 500);
                                        });
                                    }, 500);
                                });
                            }, 2000);
                        });
                    }, 1000);
                }, 500);
            }, 1000);
        }

        function startCountdown(element, callback) {
            let count = 3;
            const countdownInterval = setInterval(() => {
                element.textContent = count;
                element.style.opacity = 1;
                element.classList.remove('float-up-text');
                setTimeout(() => element.classList.add('float-up-text'), 10);
                count--;
                if (count < 0) {
                    clearInterval(countdownInterval);
                    element.textContent = "↓";
                    element.classList.add('arrow');
                    setTimeout(() => {
                        if (callback) callback();
                    }, 2000);
                }
            }, 2000);
        }

        function startShakeTimer(overlay, textElement, type) {
            let clicked = false;
            overlay.addEventListener('click', () => {
                clicked = true;
                clearInterval(shakeInterval);
            }, { once: true });
            const shakeInterval = setInterval(() => {
                if (!clicked && overlay.style.pointerEvents === 'auto') {
                    textElement.classList.add('shake-text');
                    setTimeout(() => textElement.classList.remove('shake-text'), 800);
                }
            }, 10000);
        }

        function typeText(element, text, speed = 100, callback) {
            let i = 0;
            element.textContent = '';
            element.style.opacity = 1;
            const interval = setInterval(() => {
                if (i < text.length) {
                    element.textContent += text.charAt(i);
                    i++;
                } else {
                    clearInterval(interval);
                    if (callback) callback();
                }
            }, speed);
        }

        function handleEnter(e, callback) {
            if (e.key === 'Enter') callback();
        }

        function checkColorAnswer() {
            if (isSubmitted) return;
            const answer = document.getElementById('colorAnswer').value.trim().toLowerCase();
            const submitButton = document.getElementById('submitColor');
            const inputField = document.getElementById('colorAnswer');
            
            if (!answer) {
                new Audio('error sound.mp3').play();
                if (navigator.vibrate) navigator.vibrate(200);
                submitButton.className = '';
                submitButton.classList.add('wrong');
                inputField.classList.add('shake');
                setTimeout(() => inputField.classList.remove('shake'), 500);
                return;
            }
            
            document.getElementById('clickSound').play();
            createLoveEffect(event);
            createFloatingCircle(event);
            let score = 0;
            let type = 'wrong';
            if (answer.includes('biru')) { score = 100; type = 'correct'; }
            else if (answer.includes('hitam')) { score = 75; type = 'correct'; }
            
            submitButton.className = '';
            submitButton.classList.add(type);
            answers[1] = { question: document.querySelector('#question2 h3').textContent, answer, type, score };
            if (!answer.includes('biru') && !answer.includes('hitam')) {
                allQuestions[1].options.push({ text: answer, score, type });
            }
            
            totalScore += score;
            updateProgressBar();
            disableOptions(2);
            document.getElementById('question2').classList.remove('active');
            currentQuestion++;
            document.getElementById(`question${currentQuestion}`).classList.add('active');
        }

        function checkDateAnswer() {
            if (isSubmitted) return;
            const answer = document.getElementById('dateAnswer').value.trim().toLowerCase();
            const submitButton = document.getElementById('submitDate');
            const inputField = document.getElementById('dateAnswer');
            
            if (!answer) {
                new Audio('error sound.mp3').play();
                if (navigator.vibrate) navigator.vibrate(200);
                submitButton.className = '';
                submitButton.classList.add('wrong');
                inputField.classList.add('shake');
                setTimeout(() => inputField.classList.remove('shake'), 500);
                return;
            }
            
            document.getElementById('clickSound').play();
            createLoveEffect(event);
            createFloatingCircle(event);
            let score = 0;
            let type = 'wrong';
            const datePattern = /(19\s*(th)?\s*(disember|december|dis|dec)(\s*(2022|22))?|(19)[./-]\s*(12|dis|dec)(\s*[./-]?\s*(2022|22))?)/i;
            if (datePattern.test(answer)) { score = 100; type = 'correct'; }
            
            submitButton.className = '';
            submitButton.classList.add(type);
            answers[3] = { question: document.querySelector('#question4 h3').textContent, answer, type, score };
            if (score === 0) allQuestions[3].options.push({ text: answer, score, type });
            
            totalScore += score;
            updateProgressBar();
            disableOptions(4);
            document.getElementById('question4').classList.remove('active');
            currentQuestion++;
            document.getElementById(`question${currentQuestion}`).classList.add('active');
        }

        function updateProgressBar() {
            const percentage = Math.min(Math.round((totalScore / maxScore) * 100), 100);
            const progressBar = document.getElementById('progressBar');
            progressBar.style.width = percentage + '%';
            if (percentage < 30) {
                progressBar.style.background = '#e74c3c';
            } else if (percentage < 60) {
                progressBar.style.background = '#ff9a9e';
            } else if (percentage < 80) {
                progressBar.style.background = '#3498db';
            } else {
                progressBar.style.background = '#2ecc71';
            }
            progressBar.textContent = `${percentage}%`;
            progressBar.classList.add('shake-progress');
            setTimeout(() => progressBar.classList.remove('shake-progress'), 500);
            updateLoveHeart(percentage);
        }

        function showLoveLetter() {
            const loveLetter = document.getElementById('loveLetter');
            loveLetter.style.display = 'block';
            loveLetter.scrollIntoView({ behavior: 'smooth' });
        }

        function sendEmail() {
            const emailBody = answers.map((ans, index) => 
                `${index + 1}. ${ans.question}\n   Jawapan: ${ans.answer} (${ans.score} markah)`
            ).join('\n\n') + `\n\nJumlah Skor: ${totalScore}/${maxScore} (${Math.round((totalScore / maxScore) * 100)}%)`;
            
            fetch('https://formspree.io/f/xqapwldd', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({ email: 'mdanialarif07@gmail.com', message: emailBody })
            }).then(response => {
                if (response.ok) console.log('Email sent successfully');
                else console.error('Failed to send email');
            }).catch(error => console.error('Error:', error));
        }

        function showReview() {
            document.getElementById('clickSound').play();
            createLoveEffect(event);
            createFloatingCircle(event);
            const reviewContent = document.getElementById('reviewContent');
            reviewContent.innerHTML = '';
            allQuestions.forEach((q, index) => {
                const qDiv = document.createElement('div');
                qDiv.className = 'review-question';
                qDiv.innerHTML = `<strong>${q.question}</strong>`;
                q.options.forEach(option => {
                    const isSelected = answers[index] && answers[index].answer === option.text;
                    const aDiv = document.createElement('div');
                    aDiv.className = `review-answer review-${option.type}${isSelected ? ' review-selected' : ''}`;
                    aDiv.innerHTML = `${option.text} (${option.score} markah)`;
                    qDiv.appendChild(aDiv);
                });
                reviewContent.appendChild(qDiv);
            });
            document.getElementById('reviewContainer').style.display = 'block';
            document.getElementById('reviewBtn').style.display = 'none';
            document.getElementById('loveLetter').style.display = 'none';
        }

        function hideReview() {
            document.getElementById('clickSound').play();
            createLoveEffect(event);
            createFloatingCircle(event);
            const reviewContainer = document.getElementById('reviewContainer');
            const reviewBtn = document.getElementById('reviewBtn');
            const loveLetter = document.getElementById('loveLetter');
            reviewContainer.style.display = 'none';
            reviewBtn.style.display = 'block';
            loveLetter.style.display = 'block';
        }

        function toggleMute() {
            document.getElementById('clickSound').play();
            createLoveEffect(event);
            createFloatingCircle(event);
            const backgroundMusic = document.getElementById('backgroundMusic');
            const birthdayMusic = document.getElementById('birthdayMusic');
            const muteBtn = document.getElementById('muteBtn');
            const bgVolume = document.getElementById('bgVolume');
            const activeMusic = document.getElementById('loveLetter').style.display === 'block' ? birthdayMusic : backgroundMusic;
            
            if (activeMusic.paused || activeMusic.muted) {
                activeMusic.muted = false;
                activeMusic.play();
                muteBtn.textContent = '🔊';
                muteBtn.classList.remove('muted');
                bgVolume.value = activeMusic.volume * 100;
                wasMutedManually = false;
            } else {
                activeMusic.muted = true;
                activeMusic.pause();
                muteBtn.textContent = '🔇';
                muteBtn.classList.add('muted');
                bgVolume.value = 0;
                wasMutedManually = true;
            }
        }

        function showVideo() {
            document.getElementById('clickSound').play();
            createLoveEffect(event);
            createFloatingCircle(event);
            const videoContainer = document.getElementById('videoContainer');
            const playBtn = document.querySelector('.play-video-btn');
            videoContainer.style.display = 'block';
            playBtn.style.display = 'none';
            document.getElementById('specialVideo').play();
            videoContainer.scrollIntoView({ behavior: 'smooth' });
        }

        function hideVideo() {
            document.getElementById('clickSound').play();
            createLoveEffect(event);
            createFloatingCircle(event);
            const videoContainer = document.getElementById('videoContainer');
            const playBtn = document.querySelector('.play-video-btn');
            const video = document.getElementById('specialVideo');
            videoContainer.style.display = 'none';
            playBtn.style.display = 'block';
            video.pause();
            if (!wasMutedManually) document.getElementById('birthdayMusic').play();
            document.getElementById('loveLetter').scrollIntoView({ behavior: 'smooth' });
        }

        function createFloatingCircle(event) {
            const symbols = ['🌸', '❤', '💖', '🌷', '💞'];
            const circle = document.createElement('div');
            circle.className = 'floating-circle';
            circle.textContent = symbols[Math.floor(Math.random() * symbols.length)];
            circle.style.left = `${event.clientX}px`;
            circle.style.top = `${event.clientY}px`;
            document.body.appendChild(circle);
            setTimeout(() => circle.remove(), 2000);
        }

        document.addEventListener('click', createFloatingCircle);
    </script>
</body>
</html>
